{"plane": "mgmt-plane", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "commandGroups": [{"name": "image builder", "commands": [{"name": "show", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["n", "name", "image-template-name"], "required": true, "idPart": "name", "help": {"short": "The name of the image Template"}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}], "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}]}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}, {"name": "delete", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["n", "name", "image-template-name"], "required": true, "idPart": "name", "help": {"short": "The name of the image Template"}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}], "operations": [{"longRunning": {"finalStateVia": "location"}, "operationId": "VirtualMachineImageTemplates_Delete", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "delete", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200]}, {"statusCode": [202], "header": {"items": [{"name": "Location"}]}}, {"statusCode": [204]}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "confirmation": "Are you sure you want to perform this operation?"}, {"name": "create", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["n", "name", "image-template-name"], "required": true, "idPart": "name", "help": {"short": "The name of the image Template"}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}, {"name": "Parameters", "args": [{"type": "object", "var": "$parameters.identity", "options": ["identity"], "required": true, "group": "Parameters", "help": {"short": "The identity of the image template, if configured."}, "args": [{"type": "string", "var": "$parameters.identity.type", "options": ["type"], "help": {"short": "The type of identity used for the image template. The type 'None' will remove any identities from the image template."}, "enum": {"items": [{"name": "None", "value": "None"}, {"name": "UserAssigned", "value": "UserAssigned"}]}}, {"type": "object", "var": "$parameters.identity.userAssignedIdentities", "options": ["user-assigned-identities"], "help": {"short": "The set of user assigned identities associated with the resource. The userAssignedIdentities dictionary keys will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}. The dictionary values can be empty objects ({}) in requests."}, "additionalProps": {"item": {"blank": {"value": {}}, "type": "object"}}}]}, {"type": "ResourceLocation", "var": "$parameters.location", "options": ["l", "location"], "required": true, "group": "Parameters", "help": {"short": "The geo-location where the resource lives"}}, {"type": "object", "var": "$parameters.tags", "options": ["tags"], "group": "Parameters", "help": {"short": "Resource tags."}, "additionalProps": {"item": {"type": "string"}}}]}, {"name": "Properties", "args": [{"type": "integer32", "var": "$parameters.properties.buildTimeoutInMinutes", "options": ["build-timeout-in-minutes"], "group": "Properties", "help": {"short": "Maximum duration to wait while building the image template (includes all customizations, optimization, validations, and distributions). Omit or specify 0 to use the default (4 hours)."}, "default": {"value": 0}, "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "var": "$parameters.properties.customize", "options": ["customize"], "group": "Properties", "help": {"short": "Specifies the properties used to describe the customization steps of the image, like Image source etc"}, "item": {"type": "object", "args": [{"type": "object", "var": "$parameters.properties.customize[].File", "options": ["file"], "args": [{"type": "string", "var": "$parameters.properties.customize[].File.destination", "options": ["destination"], "help": {"short": "The absolute path to a file (with nested directory structures already created) where the file (from sourceUri) will be uploaded to in the VM"}}, {"type": "string", "var": "$parameters.properties.customize[].File.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the file provided in the sourceUri field above"}, "default": {"value": ""}}, {"type": "string", "var": "$parameters.properties.customize[].File.sourceUri", "options": ["source-uri"], "help": {"short": "The URI of the file to be uploaded for customizing the VM. It can be a github link, SAS URI for Azure Storage, etc"}}]}, {"type": "object", "var": "$parameters.properties.customize[].PowerShell", "options": ["power-shell"], "args": [{"type": "array<string>", "var": "$parameters.properties.customize[].PowerShell.inline", "options": ["inline"], "help": {"short": "Array of PowerShell commands to execute"}, "item": {"type": "string"}}, {"type": "boolean", "var": "$parameters.properties.customize[].PowerShell.runAsSystem", "options": ["run-as-system"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges using the Local System user. Can only be true when the runElevated field above is set to true."}, "default": {"value": false}}, {"type": "boolean", "var": "$parameters.properties.customize[].PowerShell.runElevated", "options": ["run-elevated"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges"}, "default": {"value": false}}, {"type": "string", "var": "$parameters.properties.customize[].PowerShell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the PowerShell script to be run for customizing. It can be a github link, SAS URI for Azure Storage, etc"}}, {"type": "string", "var": "$parameters.properties.customize[].PowerShell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the power shell script provided in the scriptUri field above"}, "default": {"value": ""}}, {"type": "array<integer32>", "var": "$parameters.properties.customize[].PowerShell.validExitCodes", "options": ["valid-exit-codes"], "help": {"short": "Valid exit codes for the PowerShell script. [Default: 0]"}, "item": {"type": "integer32"}}]}, {"type": "object", "var": "$parameters.properties.customize[].Shell", "options": ["shell"], "args": [{"type": "array<string>", "var": "$parameters.properties.customize[].Shell.inline", "options": ["inline"], "help": {"short": "Array of shell commands to execute"}, "item": {"type": "string"}}, {"type": "string", "var": "$parameters.properties.customize[].Shell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the shell script to be run for customizing. It can be a github link, SAS URI for Azure Storage, etc"}}, {"type": "string", "var": "$parameters.properties.customize[].Shell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the shell script provided in the scriptUri field"}, "default": {"value": ""}}]}, {"type": "object", "var": "$parameters.properties.customize[].WindowsRestart", "options": ["windows-restart"], "args": [{"type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartCheckCommand", "options": ["restart-check-command"], "help": {"short": "Command to check if restart succeeded [Default: '']"}}, {"type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartCommand", "options": ["restart-command"], "help": {"short": "Command to execute the restart [Default: 'shutdown /r /f /t 0 /c \"packer restart\"']"}}, {"type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartTimeout", "options": ["restart-timeout"], "help": {"short": "Restart timeout specified as a string of magnitude and unit, e.g. '5m' (5 minutes) or '2h' (2 hours) [Default: '5m']"}}]}, {"type": "object", "var": "$parameters.properties.customize[].WindowsUpdate", "options": ["windows-update"], "args": [{"type": "array<string>", "var": "$parameters.properties.customize[].WindowsUpdate.filters", "options": ["filters"], "help": {"short": "Array of filters to select updates to apply. Omit or specify empty array to use the default (no filter). Refer to above link for examples and detailed description of this field."}, "item": {"type": "string"}}, {"type": "string", "var": "$parameters.properties.customize[].WindowsUpdate.searchCriteria", "options": ["search-criteria"], "help": {"short": "Criteria to search updates. Omit or specify empty string to use the default (search all). Refer to above link for examples and detailed description of this field."}}, {"type": "integer32", "var": "$parameters.properties.customize[].WindowsUpdate.updateLimit", "options": ["update-limit"], "help": {"short": "Maximum number of updates to apply at a time. Omit or specify 0 to use the default (1000)"}, "default": {"value": 0}, "format": {"minimum": 0}}]}, {"type": "string", "var": "$parameters.properties.customize[].name", "options": ["name"], "help": {"short": "Friendly Name to provide context on what this customization step does"}}]}}, {"type": "array<object>", "var": "$parameters.properties.distribute", "options": ["distribute"], "group": "Properties", "help": {"short": "The distribution targets where the image output needs to go to."}, "item": {"type": "object", "args": [{"type": "object", "var": "$parameters.properties.distribute[].ManagedImage", "options": ["managed-image"], "args": [{"type": "string", "var": "$parameters.properties.distribute[].ManagedImage.imageId", "options": ["image-id"], "required": true, "help": {"short": "Resource Id of the Managed Disk Image"}}, {"type": "string", "var": "$parameters.properties.distribute[].ManagedImage.location", "options": ["location"], "required": true, "help": {"short": "Azure location for the image, should match if image already exists"}}]}, {"type": "object", "var": "$parameters.properties.distribute[].SharedImage", "options": ["shared-image"], "args": [{"type": "boolean", "var": "$parameters.properties.distribute[].SharedImage.excludeFromLatest", "options": ["exclude-from-latest"], "help": {"short": "Flag that indicates whether created image version should be excluded from latest. Omit to use the default (false)."}, "default": {"value": false}}, {"type": "string", "var": "$parameters.properties.distribute[].SharedImage.galleryImageId", "options": ["gallery-image-id"], "required": true, "help": {"short": "Resource Id of the Azure Compute Gallery image"}}, {"type": "array<string>", "var": "$parameters.properties.distribute[].SharedImage.replicationRegions", "options": ["replication-regions"], "help": {"short": "[Deprecated] A list of regions that the image will be replicated to. This list can be specified only if targetRegions is not specified. This field is deprecated - use targetRegions instead."}, "item": {"type": "string"}}, {"type": "string", "var": "$parameters.properties.distribute[].SharedImage.storageAccountType", "options": ["storage-account-type"], "help": {"short": "[Deprecated] Storage account type to be used to store the shared image. Omit to use the default (Standard_LRS). This field can be specified only if replicationRegions is specified. This field is deprecated - use targetRegions instead."}, "enum": {"items": [{"name": "Premium_LRS", "value": "Premium_LRS"}, {"name": "Standard_LRS", "value": "Standard_LRS"}, {"name": "Standard_ZRS", "value": "Standard_ZRS"}]}}, {"type": "array<object>", "var": "$parameters.properties.distribute[].SharedImage.targetRegions", "options": ["target-regions"], "help": {"short": "The target regions where the distributed Image Version is going to be replicated to. This object supersedes replicationRegions and can be specified only if replicationRegions is not specified."}, "item": {"type": "object", "args": [{"type": "string", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].name", "options": ["name"], "required": true, "help": {"short": "The name of the region."}}, {"type": "integer32", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].replicaCount", "options": ["replica-count"], "help": {"short": "The number of replicas of the Image Version to be created in this region. Omit to use the default (1)."}, "default": {"value": 1}, "format": {"minimum": 1}}, {"type": "string", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].storageAccountType", "options": ["storage-account-type"], "help": {"short": "Specifies the storage account type to be used to store the image in this region. Omit to use the default (Standard_LRS)."}, "enum": {"items": [{"name": "Premium_LRS", "value": "Premium_LRS"}, {"name": "Standard_LRS", "value": "Standard_LRS"}, {"name": "Standard_ZRS", "value": "Standard_ZRS"}]}}]}}, {"type": "object", "var": "$parameters.properties.distribute[].SharedImage.versioning", "options": ["versioning"], "help": {"short": "Describes how to generate new x.y.z version number for distribution."}, "args": [{"type": "object", "var": "$parameters.properties.distribute[].SharedImage.versioning.Latest", "options": ["latest"], "args": [{"type": "integer32", "var": "$parameters.properties.distribute[].SharedImage.versioning.Latest.major", "options": ["major"], "help": {"short": "Major version for the generated version number. Determine what is \"latest\" based on versions with this value as the major version. -1 is equivalent to leaving it unset."}, "default": {"value": -1}, "format": {"minimum": -1}}]}]}]}, {"type": "object", "var": "$parameters.properties.distribute[].VHD", "options": ["vhd"], "args": [{"type": "string", "var": "$parameters.properties.distribute[].VHD.uri", "options": ["uri"], "help": {"short": "Optional Azure Storage URI for the distributed VHD blob. Omit to use the default (empty string) in which case VHD would be published to the storage account in the staging resource group."}}]}, {"type": "object", "var": "$parameters.properties.distribute[].artifactTags", "options": ["artifact-tags"], "help": {"short": "Tags that will be applied to the artifact once it has been created/updated by the distributor."}, "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "var": "$parameters.properties.distribute[].runOutputName", "options": ["run-output-name"], "required": true, "help": {"short": "The name to be used for the associated RunOutput."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}]}}, {"type": "object", "var": "$parameters.properties.optimize", "options": ["optimize"], "group": "Properties", "help": {"short": "Specifies optimization to be performed on image."}, "args": [{"type": "object", "var": "$parameters.properties.optimize.vmBoot", "options": ["vm-boot"], "help": {"short": "Optimization is applied on the image for a faster VM boot."}, "args": [{"type": "string", "var": "$parameters.properties.optimize.vmBoot.state", "options": ["state"], "help": {"short": "Enabling this field will improve VM boot time by optimizing the final customized image output."}, "enum": {"items": [{"name": "Disabled", "value": "Disabled"}, {"name": "Enabled", "value": "Enabled"}]}}]}]}, {"type": "object", "var": "$parameters.properties.source", "options": ["source"], "group": "Properties", "help": {"short": "Specifies the properties used to describe the source image."}, "args": [{"type": "object", "var": "$parameters.properties.source.ManagedImage", "options": ["managed-image"], "args": [{"type": "string", "var": "$parameters.properties.source.ManagedImage.imageId", "options": ["image-id"], "required": true, "help": {"short": "ARM resource id of the managed image in customer subscription"}}]}, {"type": "object", "var": "$parameters.properties.source.PlatformImage", "options": ["platform-image"], "args": [{"type": "string", "var": "$parameters.properties.source.PlatformImage.offer", "options": ["offer"], "help": {"short": "Image offer from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"type": "object", "var": "$parameters.properties.source.PlatformImage.planInfo", "options": ["plan-info"], "help": {"short": "Optional configuration of purchase plan for platform image."}, "args": [{"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planName", "options": ["plan-name"], "required": true, "help": {"short": "Name of the purchase plan."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planProduct", "options": ["plan-product"], "required": true, "help": {"short": "Product of the purchase plan."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planPublisher", "options": ["plan-publisher"], "required": true, "help": {"short": "Publisher of the purchase plan."}}]}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.publisher", "options": ["publisher"], "help": {"short": "Image Publisher in [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.sku", "options": ["sku"], "help": {"short": "Image sku from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.version", "options": ["version"], "help": {"short": "Image version from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages). If 'latest' is specified here, the version is evaluated when the image build takes place, not when the template is submitted."}}]}, {"type": "object", "var": "$parameters.properties.source.SharedImageVersion", "options": ["shared-image-version"], "args": [{"type": "string", "var": "$parameters.properties.source.SharedImageVersion.imageVersionId", "options": ["image-version-id"], "required": true, "help": {"short": "ARM resource id of the image version. When image version name is 'latest', the version is evaluated when the image build takes place."}}]}]}, {"type": "string", "var": "$parameters.properties.stagingResourceGroup", "options": ["staging-resource-group"], "group": "Properties", "help": {"short": "The staging resource group id in the same subscription as the image template that will be used to build the image. If this field is empty, a resource group with a random name will be created. If the resource group specified in this field doesn't exist, it will be created with the same name. If the resource group specified exists, it must be empty and in the same region as the image template. The resource group created will be deleted during template deletion if this field is empty or the resource group specified doesn't exist, but if the resource group specified exists the resources created in the resource group will be deleted during template deletion and the resource group itself will remain."}}, {"type": "object", "var": "$parameters.properties.validate", "options": ["validate"], "group": "Properties", "help": {"short": "Configuration options and list of validations to be performed on the resulting image."}, "args": [{"type": "boolean", "var": "$parameters.properties.validate.continueDistributeOnFailure", "options": ["continue-distribute-on-failure"], "help": {"short": "If validation fails and this field is set to false, output image(s) will not be distributed. This is the default behavior. If validation fails and this field is set to true, output image(s) will still be distributed. Please use this option with caution as it may result in bad images being distributed for use. In either case (true or false), the end to end image run will be reported as having failed in case of a validation failure. [Note: This field has no effect if validation succeeds.]"}, "default": {"value": false}}, {"type": "array<object>", "var": "$parameters.properties.validate.inVMValidations", "options": ["in-vm-validations"], "help": {"short": "List of validations to be performed."}, "item": {"type": "object", "args": [{"type": "object", "var": "$parameters.properties.validate.inVMValidations[].File", "options": ["file"], "args": [{"type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.destination", "options": ["destination"], "help": {"short": "The absolute path to a file (with nested directory structures already created) where the file (from sourceUri) will be uploaded to in the VM"}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the file provided in the sourceUri field above"}, "default": {"value": ""}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.sourceUri", "options": ["source-uri"], "help": {"short": "The URI of the file to be uploaded to the VM for validation. It can be a github link, Azure Storage URI (authorized or SAS), etc"}}]}, {"type": "object", "var": "$parameters.properties.validate.inVMValidations[].PowerShell", "options": ["power-shell"], "args": [{"type": "array<string>", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.inline", "options": ["inline"], "help": {"short": "Array of PowerShell commands to execute"}, "item": {"type": "string"}}, {"type": "boolean", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.runAsSystem", "options": ["run-as-system"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges using the Local System user. Can only be true when the runElevated field above is set to true."}, "default": {"value": false}}, {"type": "boolean", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.runElevated", "options": ["run-elevated"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges"}, "default": {"value": false}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the PowerShell script to be run for validation. It can be a github link, Azure Storage URI, etc"}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the power shell script provided in the scriptUri field above"}, "default": {"value": ""}}, {"type": "array<integer32>", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.validExitCodes", "options": ["valid-exit-codes"], "help": {"short": "Valid exit codes for the PowerShell script. [Default: 0]"}, "item": {"type": "integer32"}}]}, {"type": "object", "var": "$parameters.properties.validate.inVMValidations[].Shell", "options": ["shell"], "args": [{"type": "array<string>", "var": "$parameters.properties.validate.inVMValidations[].Shell.inline", "options": ["inline"], "help": {"short": "Array of shell commands to execute"}, "item": {"type": "string"}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].Shell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the shell script to be run for validation. It can be a github link, Azure Storage URI, etc"}}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].Shell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the shell script provided in the scriptUri field"}, "default": {"value": ""}}]}, {"type": "string", "var": "$parameters.properties.validate.inVMValidations[].name", "options": ["name"], "help": {"short": "Friendly Name to provide context on what this validation step does"}}]}}, {"type": "boolean", "var": "$parameters.properties.validate.sourceValidationOnly", "options": ["source-validation-only"], "help": {"short": "If this field is set to true, the image specified in the 'source' section will directly be validated. No separate build will be run to generate and then validate a customized image."}, "default": {"value": false}}]}, {"type": "object", "var": "$parameters.properties.vmProfile", "options": ["vm-profile"], "group": "Properties", "help": {"short": "Describes how virtual machine is set up to build images"}, "args": [{"type": "integer32", "var": "$parameters.properties.vmProfile.osDiskSizeGB", "options": ["os-disk-size-gb"], "help": {"short": "Size of the OS disk in GB. Omit or specify 0 to use Azure's default OS disk size."}, "default": {"value": 0}, "format": {"minimum": 0}}, {"type": "array<string>", "var": "$parameters.properties.vmProfile.userAssignedIdentities", "options": ["user-assigned-identities"], "help": {"short": "Optional array of resource IDs of user assigned managed identities to be configured on the build VM and validation VM. This may include the identity of the image template."}, "item": {"type": "string"}}, {"type": "string", "var": "$parameters.properties.vmProfile.vmSize", "options": ["vm-size"], "help": {"short": "Size of the virtual machine used to build, customize and capture images. Omit or specify empty string to use the default (Standard_D1_v2 for Gen1 images and Standard_D2ds_v4 for Gen2 images)."}, "default": {"value": ""}}, {"type": "object", "var": "$parameters.properties.vmProfile.vnetConfig", "options": ["vnet-config"], "help": {"short": "Optional configuration of the virtual network to use to deploy the build VM and validation VM in. Omit if no specific virtual network needs to be used."}, "args": [{"type": "string", "var": "$parameters.properties.vmProfile.vnetConfig.proxyVmSize", "options": ["proxy-vm-size"], "help": {"short": "Size of the proxy virtual machine used to pass traffic to the build VM and validation VM. Omit or specify empty string to use the default (Standard_A1_v2)."}, "default": {"value": ""}}, {"type": "string", "var": "$parameters.properties.vmProfile.vnetConfig.subnetId", "options": ["subnet-id"], "help": {"short": "Resource id of a pre-existing subnet."}}]}]}]}], "operations": [{"longRunning": {"finalStateVia": "azure-async-operation"}, "operationId": "VirtualMachineImageTemplates_CreateOrUpdate", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"schema": {"type": "object", "name": "parameters", "required": true, "props": [{"type": "IdentityObject", "name": "identity", "arg": "$parameters.identity", "required": true, "props": [{"type": "string", "name": "type", "arg": "$parameters.identity.type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "arg": "$parameters.identity.userAssignedIdentities", "additionalProps": {"item": {"type": "object"}}}]}, {"type": "ResourceLocation", "name": "location", "arg": "$parameters.location", "required": true}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "arg": "$parameters.properties.buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "arg": "$parameters.properties.customize", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.customize[].name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.customize[].File", "value": "File"}, {"arg": "$parameters.properties.customize[].PowerShell", "value": "PowerShell"}, {"arg": "$parameters.properties.customize[].Shell", "value": "Shell"}, {"arg": "$parameters.properties.customize[].WindowsRestart", "value": "WindowsRestart"}, {"arg": "$parameters.properties.customize[].WindowsUpdate", "value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination", "arg": "$parameters.properties.customize[].File.destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].File.sha256Checksum"}, {"type": "string", "name": "sourceUri", "arg": "$parameters.properties.customize[].File.sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.customize[].PowerShell.inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem", "arg": "$parameters.properties.customize[].PowerShell.runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated", "arg": "$parameters.properties.customize[].PowerShell.runElevated"}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.customize[].PowerShell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].PowerShell.sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "arg": "$parameters.properties.customize[].PowerShell.validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.customize[].Shell.inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.customize[].Shell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].Shell.sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand", "arg": "$parameters.properties.customize[].WindowsRestart.restartCheckCommand"}, {"type": "string", "name": "restartCommand", "arg": "$parameters.properties.customize[].WindowsRestart.restartCommand"}, {"type": "string", "name": "restartTimeout", "arg": "$parameters.properties.customize[].WindowsRestart.restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "arg": "$parameters.properties.customize[].WindowsUpdate.filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria", "arg": "$parameters.properties.customize[].WindowsUpdate.searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "arg": "$parameters.properties.customize[].WindowsUpdate.updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "arg": "$parameters.properties.distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "arg": "$parameters.properties.distribute[].artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "arg": "$parameters.properties.distribute[].runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.distribute[].ManagedImage", "value": "ManagedImage"}, {"arg": "$parameters.properties.distribute[].SharedImage", "value": "SharedImage"}, {"arg": "$parameters.properties.distribute[].VHD", "value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "arg": "$parameters.properties.distribute[].ManagedImage.imageId", "required": true}, {"type": "string", "name": "location", "arg": "$parameters.properties.distribute[].ManagedImage.location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest", "arg": "$parameters.properties.distribute[].SharedImage.excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "arg": "$parameters.properties.distribute[].SharedImage.galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "arg": "$parameters.properties.distribute[].SharedImage.replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "arg": "$parameters.properties.distribute[].SharedImage.storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "arg": "$parameters.properties.distribute[].SharedImage.versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"arg": "$parameters.properties.distribute[].SharedImage.versioning.Latest", "value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "arg": "$parameters.properties.distribute[].SharedImage.versioning.Latest.major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri", "arg": "$parameters.properties.distribute[].VHD.uri"}]}]}}, {"type": "object", "name": "optimize", "arg": "$parameters.properties.optimize", "props": [{"type": "object", "name": "vmBoot", "arg": "$parameters.properties.optimize.vmBoot", "props": [{"type": "string", "name": "state", "arg": "$parameters.properties.optimize.vmBoot.state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "source", "arg": "$parameters.properties.source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.source.ManagedImage", "value": "ManagedImage"}, {"arg": "$parameters.properties.source.PlatformImage", "value": "PlatformImage"}, {"arg": "$parameters.properties.source.SharedImageVersion", "value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "arg": "$parameters.properties.source.ManagedImage.imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"type": "string", "name": "offer", "arg": "$parameters.properties.source.PlatformImage.offer"}, {"type": "object", "name": "planInfo", "arg": "$parameters.properties.source.PlatformImage.planInfo", "props": [{"type": "string", "name": "planName", "arg": "$parameters.properties.source.PlatformImage.planInfo.planName", "required": true}, {"type": "string", "name": "planProduct", "arg": "$parameters.properties.source.PlatformImage.planInfo.planProduct", "required": true}, {"type": "string", "name": "planPublisher", "arg": "$parameters.properties.source.PlatformImage.planInfo.planPublisher", "required": true}]}, {"type": "string", "name": "publisher", "arg": "$parameters.properties.source.PlatformImage.publisher"}, {"type": "string", "name": "sku", "arg": "$parameters.properties.source.PlatformImage.sku"}, {"type": "string", "name": "version", "arg": "$parameters.properties.source.PlatformImage.version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"type": "string", "name": "imageVersionId", "arg": "$parameters.properties.source.SharedImageVersion.imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup", "arg": "$parameters.properties.stagingResourceGroup"}, {"type": "object", "name": "validate", "arg": "$parameters.properties.validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure", "arg": "$parameters.properties.validate.continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "arg": "$parameters.properties.validate.inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.validate.inVMValidations[].name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.validate.inVMValidations[].File", "value": "File"}, {"arg": "$parameters.properties.validate.inVMValidations[].PowerShell", "value": "PowerShell"}, {"arg": "$parameters.properties.validate.inVMValidations[].Shell", "value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination", "arg": "$parameters.properties.validate.inVMValidations[].File.destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].File.sha256Checksum"}, {"type": "string", "name": "sourceUri", "arg": "$parameters.properties.validate.inVMValidations[].File.sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.runElevated"}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.validate.inVMValidations[].Shell.inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.validate.inVMValidations[].Shell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].Shell.sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly", "arg": "$parameters.properties.validate.sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "arg": "$parameters.properties.vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "arg": "$parameters.properties.vmProfile.osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "arg": "$parameters.properties.vmProfile.userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize", "arg": "$parameters.properties.vmProfile.vmSize"}, {"type": "object", "name": "vnetConfig", "arg": "$parameters.properties.vmProfile.vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize", "arg": "$parameters.properties.vmProfile.vnetConfig.proxyVmSize"}, {"type": "string", "name": "subnetId", "arg": "$parameters.properties.vmProfile.vnetConfig.subnetId"}]}]}], "clientFlatten": true}, {"type": "object", "name": "tags", "arg": "$parameters.tags", "additionalProps": {"item": {"type": "string"}}}], "clientFlatten": true}}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}]}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}, {"name": "update", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["n", "name", "image-template-name"], "required": true, "idPart": "name", "help": {"short": "The name of the image Template"}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}, {"name": "Parameters", "args": [{"type": "object", "var": "$parameters.identity", "options": ["identity"], "group": "Parameters", "help": {"short": "The identity of the image template, if configured."}, "args": [{"nullable": true, "type": "string", "var": "$parameters.identity.type", "options": ["type"], "help": {"short": "The type of identity used for the image template. The type 'None' will remove any identities from the image template."}, "enum": {"items": [{"name": "None", "value": "None"}, {"name": "UserAssigned", "value": "UserAssigned"}]}}, {"nullable": true, "type": "object", "var": "$parameters.identity.userAssignedIdentities", "options": ["user-assigned-identities"], "help": {"short": "The set of user assigned identities associated with the resource. The userAssignedIdentities dictionary keys will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}. The dictionary values can be empty objects ({}) in requests."}, "additionalProps": {"item": {"nullable": true, "blank": {"value": {}}, "type": "object"}}}]}, {"nullable": true, "type": "object", "var": "$parameters.tags", "options": ["tags"], "group": "Parameters", "help": {"short": "Resource tags."}, "additionalProps": {"item": {"nullable": true, "type": "string"}}}]}, {"name": "Properties", "args": [{"nullable": true, "type": "integer32", "var": "$parameters.properties.buildTimeoutInMinutes", "options": ["build-timeout-in-minutes"], "group": "Properties", "help": {"short": "Maximum duration to wait while building the image template (includes all customizations, optimization, validations, and distributions). Omit or specify 0 to use the default (4 hours)."}, "format": {"maximum": 960, "minimum": 0}}, {"nullable": true, "type": "array<object>", "var": "$parameters.properties.customize", "options": ["customize"], "group": "Properties", "help": {"short": "Specifies the properties used to describe the customization steps of the image, like Image source etc"}, "item": {"nullable": true, "type": "object", "args": [{"type": "object", "var": "$parameters.properties.customize[].File", "options": ["file"], "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.customize[].File.destination", "options": ["destination"], "help": {"short": "The absolute path to a file (with nested directory structures already created) where the file (from sourceUri) will be uploaded to in the VM"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].File.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the file provided in the sourceUri field above"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].File.sourceUri", "options": ["source-uri"], "help": {"short": "The URI of the file to be uploaded for customizing the VM. It can be a github link, SAS URI for Azure Storage, etc"}}]}, {"type": "object", "var": "$parameters.properties.customize[].PowerShell", "options": ["power-shell"], "args": [{"nullable": true, "type": "array<string>", "var": "$parameters.properties.customize[].PowerShell.inline", "options": ["inline"], "help": {"short": "Array of PowerShell commands to execute"}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "boolean", "var": "$parameters.properties.customize[].PowerShell.runAsSystem", "options": ["run-as-system"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges using the Local System user. Can only be true when the runElevated field above is set to true."}}, {"nullable": true, "type": "boolean", "var": "$parameters.properties.customize[].PowerShell.runElevated", "options": ["run-elevated"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].PowerShell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the PowerShell script to be run for customizing. It can be a github link, SAS URI for Azure Storage, etc"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].PowerShell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the power shell script provided in the scriptUri field above"}}, {"nullable": true, "type": "array<integer32>", "var": "$parameters.properties.customize[].PowerShell.validExitCodes", "options": ["valid-exit-codes"], "help": {"short": "Valid exit codes for the PowerShell script. [Default: 0]"}, "item": {"nullable": true, "type": "integer32"}}]}, {"type": "object", "var": "$parameters.properties.customize[].Shell", "options": ["shell"], "args": [{"nullable": true, "type": "array<string>", "var": "$parameters.properties.customize[].Shell.inline", "options": ["inline"], "help": {"short": "Array of shell commands to execute"}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].Shell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the shell script to be run for customizing. It can be a github link, SAS URI for Azure Storage, etc"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].Shell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the shell script provided in the scriptUri field"}}]}, {"type": "object", "var": "$parameters.properties.customize[].WindowsRestart", "options": ["windows-restart"], "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartCheckCommand", "options": ["restart-check-command"], "help": {"short": "Command to check if restart succeeded [Default: '']"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartCommand", "options": ["restart-command"], "help": {"short": "Command to execute the restart [Default: 'shutdown /r /f /t 0 /c \"packer restart\"']"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].WindowsRestart.restartTimeout", "options": ["restart-timeout"], "help": {"short": "Restart timeout specified as a string of magnitude and unit, e.g. '5m' (5 minutes) or '2h' (2 hours) [Default: '5m']"}}]}, {"type": "object", "var": "$parameters.properties.customize[].WindowsUpdate", "options": ["windows-update"], "args": [{"nullable": true, "type": "array<string>", "var": "$parameters.properties.customize[].WindowsUpdate.filters", "options": ["filters"], "help": {"short": "Array of filters to select updates to apply. Omit or specify empty array to use the default (no filter). Refer to above link for examples and detailed description of this field."}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].WindowsUpdate.searchCriteria", "options": ["search-criteria"], "help": {"short": "Criteria to search updates. Omit or specify empty string to use the default (search all). Refer to above link for examples and detailed description of this field."}}, {"nullable": true, "type": "integer32", "var": "$parameters.properties.customize[].WindowsUpdate.updateLimit", "options": ["update-limit"], "help": {"short": "Maximum number of updates to apply at a time. Omit or specify 0 to use the default (1000)"}, "format": {"minimum": 0}}]}, {"nullable": true, "type": "string", "var": "$parameters.properties.customize[].name", "options": ["name"], "help": {"short": "Friendly Name to provide context on what this customization step does"}}]}}, {"type": "array<object>", "var": "$parameters.properties.distribute", "options": ["distribute"], "group": "Properties", "help": {"short": "The distribution targets where the image output needs to go to."}, "item": {"nullable": true, "type": "object", "args": [{"type": "object", "var": "$parameters.properties.distribute[].ManagedImage", "options": ["managed-image"], "args": [{"type": "string", "var": "$parameters.properties.distribute[].ManagedImage.imageId", "options": ["image-id"], "help": {"short": "Resource Id of the Managed Disk Image"}}, {"type": "string", "var": "$parameters.properties.distribute[].ManagedImage.location", "options": ["location"], "help": {"short": "Azure location for the image, should match if image already exists"}}]}, {"type": "object", "var": "$parameters.properties.distribute[].SharedImage", "options": ["shared-image"], "args": [{"nullable": true, "type": "boolean", "var": "$parameters.properties.distribute[].SharedImage.excludeFromLatest", "options": ["exclude-from-latest"], "help": {"short": "Flag that indicates whether created image version should be excluded from latest. Omit to use the default (false)."}}, {"type": "string", "var": "$parameters.properties.distribute[].SharedImage.galleryImageId", "options": ["gallery-image-id"], "help": {"short": "Resource Id of the Azure Compute Gallery image"}}, {"nullable": true, "type": "array<string>", "var": "$parameters.properties.distribute[].SharedImage.replicationRegions", "options": ["replication-regions"], "help": {"short": "[Deprecated] A list of regions that the image will be replicated to. This list can be specified only if targetRegions is not specified. This field is deprecated - use targetRegions instead."}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.distribute[].SharedImage.storageAccountType", "options": ["storage-account-type"], "help": {"short": "[Deprecated] Storage account type to be used to store the shared image. Omit to use the default (Standard_LRS). This field can be specified only if replicationRegions is specified. This field is deprecated - use targetRegions instead."}, "enum": {"items": [{"name": "Premium_LRS", "value": "Premium_LRS"}, {"name": "Standard_LRS", "value": "Standard_LRS"}, {"name": "Standard_ZRS", "value": "Standard_ZRS"}]}}, {"nullable": true, "type": "array<object>", "var": "$parameters.properties.distribute[].SharedImage.targetRegions", "options": ["target-regions"], "help": {"short": "The target regions where the distributed Image Version is going to be replicated to. This object supersedes replicationRegions and can be specified only if replicationRegions is not specified."}, "item": {"nullable": true, "type": "object", "args": [{"type": "string", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].name", "options": ["name"], "help": {"short": "The name of the region."}}, {"nullable": true, "type": "integer32", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].replicaCount", "options": ["replica-count"], "help": {"short": "The number of replicas of the Image Version to be created in this region. Omit to use the default (1)."}, "format": {"minimum": 1}}, {"nullable": true, "type": "string", "var": "$parameters.properties.distribute[].SharedImage.targetRegions[].storageAccountType", "options": ["storage-account-type"], "help": {"short": "Specifies the storage account type to be used to store the image in this region. Omit to use the default (Standard_LRS)."}, "enum": {"items": [{"name": "Premium_LRS", "value": "Premium_LRS"}, {"name": "Standard_LRS", "value": "Standard_LRS"}, {"name": "Standard_ZRS", "value": "Standard_ZRS"}]}}]}}, {"nullable": true, "type": "object", "var": "$parameters.properties.distribute[].SharedImage.versioning", "options": ["versioning"], "help": {"short": "Describes how to generate new x.y.z version number for distribution."}, "args": [{"type": "object", "var": "$parameters.properties.distribute[].SharedImage.versioning.Latest", "options": ["latest"], "args": [{"nullable": true, "type": "integer32", "var": "$parameters.properties.distribute[].SharedImage.versioning.Latest.major", "options": ["major"], "help": {"short": "Major version for the generated version number. Determine what is \"latest\" based on versions with this value as the major version. -1 is equivalent to leaving it unset."}, "format": {"minimum": -1}}]}]}]}, {"type": "object", "var": "$parameters.properties.distribute[].VHD", "options": ["vhd"], "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.distribute[].VHD.uri", "options": ["uri"], "help": {"short": "Optional Azure Storage URI for the distributed VHD blob. Omit to use the default (empty string) in which case VHD would be published to the storage account in the staging resource group."}}]}, {"nullable": true, "type": "object", "var": "$parameters.properties.distribute[].artifactTags", "options": ["artifact-tags"], "help": {"short": "Tags that will be applied to the artifact once it has been created/updated by the distributor."}, "additionalProps": {"item": {"nullable": true, "type": "string"}}}, {"type": "string", "var": "$parameters.properties.distribute[].runOutputName", "options": ["run-output-name"], "help": {"short": "The name to be used for the associated RunOutput."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}]}}, {"nullable": true, "type": "object", "var": "$parameters.properties.optimize", "options": ["optimize"], "group": "Properties", "help": {"short": "Specifies optimization to be performed on image."}, "args": [{"nullable": true, "type": "object", "var": "$parameters.properties.optimize.vmBoot", "options": ["vm-boot"], "help": {"short": "Optimization is applied on the image for a faster VM boot."}, "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.optimize.vmBoot.state", "options": ["state"], "help": {"short": "Enabling this field will improve VM boot time by optimizing the final customized image output."}, "enum": {"items": [{"name": "Disabled", "value": "Disabled"}, {"name": "Enabled", "value": "Enabled"}]}}]}]}, {"type": "object", "var": "$parameters.properties.source", "options": ["source"], "group": "Properties", "help": {"short": "Specifies the properties used to describe the source image."}, "args": [{"type": "object", "var": "$parameters.properties.source.ManagedImage", "options": ["managed-image"], "args": [{"type": "string", "var": "$parameters.properties.source.ManagedImage.imageId", "options": ["image-id"], "help": {"short": "ARM resource id of the managed image in customer subscription"}}]}, {"type": "object", "var": "$parameters.properties.source.PlatformImage", "options": ["platform-image"], "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.source.PlatformImage.offer", "options": ["offer"], "help": {"short": "Image offer from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"nullable": true, "type": "object", "var": "$parameters.properties.source.PlatformImage.planInfo", "options": ["plan-info"], "help": {"short": "Optional configuration of purchase plan for platform image."}, "args": [{"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planName", "options": ["plan-name"], "help": {"short": "Name of the purchase plan."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planProduct", "options": ["plan-product"], "help": {"short": "Product of the purchase plan."}}, {"type": "string", "var": "$parameters.properties.source.PlatformImage.planInfo.planPublisher", "options": ["plan-publisher"], "help": {"short": "Publisher of the purchase plan."}}]}, {"nullable": true, "type": "string", "var": "$parameters.properties.source.PlatformImage.publisher", "options": ["publisher"], "help": {"short": "Image Publisher in [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"nullable": true, "type": "string", "var": "$parameters.properties.source.PlatformImage.sku", "options": ["sku"], "help": {"short": "Image sku from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages)."}}, {"nullable": true, "type": "string", "var": "$parameters.properties.source.PlatformImage.version", "options": ["version"], "help": {"short": "Image version from the [Azure Gallery Images](https://docs.microsoft.com/en-us/rest/api/compute/virtualmachineimages). If 'latest' is specified here, the version is evaluated when the image build takes place, not when the template is submitted."}}]}, {"type": "object", "var": "$parameters.properties.source.SharedImageVersion", "options": ["shared-image-version"], "args": [{"type": "string", "var": "$parameters.properties.source.SharedImageVersion.imageVersionId", "options": ["image-version-id"], "help": {"short": "ARM resource id of the image version. When image version name is 'latest', the version is evaluated when the image build takes place."}}]}]}, {"nullable": true, "type": "string", "var": "$parameters.properties.stagingResourceGroup", "options": ["staging-resource-group"], "group": "Properties", "help": {"short": "The staging resource group id in the same subscription as the image template that will be used to build the image. If this field is empty, a resource group with a random name will be created. If the resource group specified in this field doesn't exist, it will be created with the same name. If the resource group specified exists, it must be empty and in the same region as the image template. The resource group created will be deleted during template deletion if this field is empty or the resource group specified doesn't exist, but if the resource group specified exists the resources created in the resource group will be deleted during template deletion and the resource group itself will remain."}}, {"nullable": true, "type": "object", "var": "$parameters.properties.validate", "options": ["validate"], "group": "Properties", "help": {"short": "Configuration options and list of validations to be performed on the resulting image."}, "args": [{"nullable": true, "type": "boolean", "var": "$parameters.properties.validate.continueDistributeOnFailure", "options": ["continue-distribute-on-failure"], "help": {"short": "If validation fails and this field is set to false, output image(s) will not be distributed. This is the default behavior. If validation fails and this field is set to true, output image(s) will still be distributed. Please use this option with caution as it may result in bad images being distributed for use. In either case (true or false), the end to end image run will be reported as having failed in case of a validation failure. [Note: This field has no effect if validation succeeds.]"}}, {"nullable": true, "type": "array<object>", "var": "$parameters.properties.validate.inVMValidations", "options": ["in-vm-validations"], "help": {"short": "List of validations to be performed."}, "item": {"nullable": true, "type": "object", "args": [{"type": "object", "var": "$parameters.properties.validate.inVMValidations[].File", "options": ["file"], "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.destination", "options": ["destination"], "help": {"short": "The absolute path to a file (with nested directory structures already created) where the file (from sourceUri) will be uploaded to in the VM"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the file provided in the sourceUri field above"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].File.sourceUri", "options": ["source-uri"], "help": {"short": "The URI of the file to be uploaded to the VM for validation. It can be a github link, Azure Storage URI (authorized or SAS), etc"}}]}, {"type": "object", "var": "$parameters.properties.validate.inVMValidations[].PowerShell", "options": ["power-shell"], "args": [{"nullable": true, "type": "array<string>", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.inline", "options": ["inline"], "help": {"short": "Array of PowerShell commands to execute"}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "boolean", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.runAsSystem", "options": ["run-as-system"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges using the Local System user. Can only be true when the runElevated field above is set to true."}}, {"nullable": true, "type": "boolean", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.runElevated", "options": ["run-elevated"], "help": {"short": "If specified, the PowerShell script will be run with elevated privileges"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the PowerShell script to be run for validation. It can be a github link, Azure Storage URI, etc"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the power shell script provided in the scriptUri field above"}}, {"nullable": true, "type": "array<integer32>", "var": "$parameters.properties.validate.inVMValidations[].PowerShell.validExitCodes", "options": ["valid-exit-codes"], "help": {"short": "Valid exit codes for the PowerShell script. [Default: 0]"}, "item": {"nullable": true, "type": "integer32"}}]}, {"type": "object", "var": "$parameters.properties.validate.inVMValidations[].Shell", "options": ["shell"], "args": [{"nullable": true, "type": "array<string>", "var": "$parameters.properties.validate.inVMValidations[].Shell.inline", "options": ["inline"], "help": {"short": "Array of shell commands to execute"}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].Shell.scriptUri", "options": ["script-uri"], "help": {"short": "URI of the shell script to be run for validation. It can be a github link, Azure Storage URI, etc"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].Shell.sha256Checksum", "options": ["sha256-checksum"], "help": {"short": "SHA256 checksum of the shell script provided in the scriptUri field"}}]}, {"nullable": true, "type": "string", "var": "$parameters.properties.validate.inVMValidations[].name", "options": ["name"], "help": {"short": "Friendly Name to provide context on what this validation step does"}}]}}, {"nullable": true, "type": "boolean", "var": "$parameters.properties.validate.sourceValidationOnly", "options": ["source-validation-only"], "help": {"short": "If this field is set to true, the image specified in the 'source' section will directly be validated. No separate build will be run to generate and then validate a customized image."}}]}, {"nullable": true, "type": "object", "var": "$parameters.properties.vmProfile", "options": ["vm-profile"], "group": "Properties", "help": {"short": "Describes how virtual machine is set up to build images"}, "args": [{"nullable": true, "type": "integer32", "var": "$parameters.properties.vmProfile.osDiskSizeGB", "options": ["os-disk-size-gb"], "help": {"short": "Size of the OS disk in GB. Omit or specify 0 to use Azure's default OS disk size."}, "format": {"minimum": 0}}, {"nullable": true, "type": "array<string>", "var": "$parameters.properties.vmProfile.userAssignedIdentities", "options": ["user-assigned-identities"], "help": {"short": "Optional array of resource IDs of user assigned managed identities to be configured on the build VM and validation VM. This may include the identity of the image template."}, "item": {"nullable": true, "type": "string"}}, {"nullable": true, "type": "string", "var": "$parameters.properties.vmProfile.vmSize", "options": ["vm-size"], "help": {"short": "Size of the virtual machine used to build, customize and capture images. Omit or specify empty string to use the default (Standard_D1_v2 for Gen1 images and Standard_D2ds_v4 for Gen2 images)."}}, {"nullable": true, "type": "object", "var": "$parameters.properties.vmProfile.vnetConfig", "options": ["vnet-config"], "help": {"short": "Optional configuration of the virtual network to use to deploy the build VM and validation VM in. Omit if no specific virtual network needs to be used."}, "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.vmProfile.vnetConfig.proxyVmSize", "options": ["proxy-vm-size"], "help": {"short": "Size of the proxy virtual machine used to pass traffic to the build VM and validation VM. Omit or specify empty string to use the default (Standard_A1_v2)."}}, {"nullable": true, "type": "string", "var": "$parameters.properties.vmProfile.vnetConfig.subnetId", "options": ["subnet-id"], "help": {"short": "Resource id of a pre-existing subnet."}}]}]}]}], "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}, {"instanceUpdate": {"ref": "$Instance", "json": {"schema": {"type": "object", "name": "parameters", "required": true, "props": [{"type": "IdentityObject", "name": "identity", "arg": "$parameters.identity", "required": true, "props": [{"type": "string", "name": "type", "arg": "$parameters.identity.type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "arg": "$parameters.identity.userAssignedIdentities", "additionalProps": {"item": {"type": "object"}}}]}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "arg": "$parameters.properties.buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "arg": "$parameters.properties.customize", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.customize[].name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.customize[].File", "value": "File"}, {"arg": "$parameters.properties.customize[].PowerShell", "value": "PowerShell"}, {"arg": "$parameters.properties.customize[].Shell", "value": "Shell"}, {"arg": "$parameters.properties.customize[].WindowsRestart", "value": "WindowsRestart"}, {"arg": "$parameters.properties.customize[].WindowsUpdate", "value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination", "arg": "$parameters.properties.customize[].File.destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].File.sha256Checksum"}, {"type": "string", "name": "sourceUri", "arg": "$parameters.properties.customize[].File.sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.customize[].PowerShell.inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem", "arg": "$parameters.properties.customize[].PowerShell.runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated", "arg": "$parameters.properties.customize[].PowerShell.runElevated"}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.customize[].PowerShell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].PowerShell.sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "arg": "$parameters.properties.customize[].PowerShell.validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.customize[].Shell.inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.customize[].Shell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.customize[].Shell.sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand", "arg": "$parameters.properties.customize[].WindowsRestart.restartCheckCommand"}, {"type": "string", "name": "restartCommand", "arg": "$parameters.properties.customize[].WindowsRestart.restartCommand"}, {"type": "string", "name": "restartTimeout", "arg": "$parameters.properties.customize[].WindowsRestart.restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "arg": "$parameters.properties.customize[].WindowsUpdate.filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria", "arg": "$parameters.properties.customize[].WindowsUpdate.searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "arg": "$parameters.properties.customize[].WindowsUpdate.updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "arg": "$parameters.properties.distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "arg": "$parameters.properties.distribute[].artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "arg": "$parameters.properties.distribute[].runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.distribute[].ManagedImage", "value": "ManagedImage"}, {"arg": "$parameters.properties.distribute[].SharedImage", "value": "SharedImage"}, {"arg": "$parameters.properties.distribute[].VHD", "value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "arg": "$parameters.properties.distribute[].ManagedImage.imageId", "required": true}, {"type": "string", "name": "location", "arg": "$parameters.properties.distribute[].ManagedImage.location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest", "arg": "$parameters.properties.distribute[].SharedImage.excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "arg": "$parameters.properties.distribute[].SharedImage.galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "arg": "$parameters.properties.distribute[].SharedImage.replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "arg": "$parameters.properties.distribute[].SharedImage.storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "arg": "$parameters.properties.distribute[].SharedImage.targetRegions[].storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "arg": "$parameters.properties.distribute[].SharedImage.versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"arg": "$parameters.properties.distribute[].SharedImage.versioning.Latest", "value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "arg": "$parameters.properties.distribute[].SharedImage.versioning.Latest.major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri", "arg": "$parameters.properties.distribute[].VHD.uri"}]}]}}, {"type": "object", "name": "optimize", "arg": "$parameters.properties.optimize", "props": [{"type": "object", "name": "vmBoot", "arg": "$parameters.properties.optimize.vmBoot", "props": [{"type": "string", "name": "state", "arg": "$parameters.properties.optimize.vmBoot.state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "source", "arg": "$parameters.properties.source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.source.ManagedImage", "value": "ManagedImage"}, {"arg": "$parameters.properties.source.PlatformImage", "value": "PlatformImage"}, {"arg": "$parameters.properties.source.SharedImageVersion", "value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "arg": "$parameters.properties.source.ManagedImage.imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"type": "string", "name": "offer", "arg": "$parameters.properties.source.PlatformImage.offer"}, {"type": "object", "name": "planInfo", "arg": "$parameters.properties.source.PlatformImage.planInfo", "props": [{"type": "string", "name": "planName", "arg": "$parameters.properties.source.PlatformImage.planInfo.planName", "required": true}, {"type": "string", "name": "planProduct", "arg": "$parameters.properties.source.PlatformImage.planInfo.planProduct", "required": true}, {"type": "string", "name": "planPublisher", "arg": "$parameters.properties.source.PlatformImage.planInfo.planPublisher", "required": true}]}, {"type": "string", "name": "publisher", "arg": "$parameters.properties.source.PlatformImage.publisher"}, {"type": "string", "name": "sku", "arg": "$parameters.properties.source.PlatformImage.sku"}, {"type": "string", "name": "version", "arg": "$parameters.properties.source.PlatformImage.version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"type": "string", "name": "imageVersionId", "arg": "$parameters.properties.source.SharedImageVersion.imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup", "arg": "$parameters.properties.stagingResourceGroup"}, {"type": "object", "name": "validate", "arg": "$parameters.properties.validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure", "arg": "$parameters.properties.validate.continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "arg": "$parameters.properties.validate.inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name", "arg": "$parameters.properties.validate.inVMValidations[].name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"arg": "$parameters.properties.validate.inVMValidations[].File", "value": "File"}, {"arg": "$parameters.properties.validate.inVMValidations[].PowerShell", "value": "PowerShell"}, {"arg": "$parameters.properties.validate.inVMValidations[].Shell", "value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination", "arg": "$parameters.properties.validate.inVMValidations[].File.destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].File.sha256Checksum"}, {"type": "string", "name": "sourceUri", "arg": "$parameters.properties.validate.inVMValidations[].File.sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.runElevated"}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "arg": "$parameters.properties.validate.inVMValidations[].PowerShell.validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "arg": "$parameters.properties.validate.inVMValidations[].Shell.inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri", "arg": "$parameters.properties.validate.inVMValidations[].Shell.scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum", "arg": "$parameters.properties.validate.inVMValidations[].Shell.sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly", "arg": "$parameters.properties.validate.sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "arg": "$parameters.properties.vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "arg": "$parameters.properties.vmProfile.osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "arg": "$parameters.properties.vmProfile.userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize", "arg": "$parameters.properties.vmProfile.vmSize"}, {"type": "object", "name": "vnetConfig", "arg": "$parameters.properties.vmProfile.vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize", "arg": "$parameters.properties.vmProfile.vnetConfig.proxyVmSize"}, {"type": "string", "name": "subnetId", "arg": "$parameters.properties.vmProfile.vnetConfig.subnetId"}]}]}], "clientFlatten": true}, {"type": "object", "name": "tags", "arg": "$parameters.tags", "additionalProps": {"item": {"type": "string"}}}], "clientFlatten": true}}}}, {"longRunning": {"finalStateVia": "azure-async-operation"}, "operationId": "VirtualMachineImageTemplates_CreateOrUpdate", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"ref": "$Instance"}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "@ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}], "commandGroups": [{"name": "optimizer", "commands": [{"name": "add", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "subresource": "properties.optimize", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["image-template-name"], "required": true, "group": "", "idPart": "name", "help": {"short": "The name of the image template."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}, {"name": "VmBoot", "args": [{"type": "string", "var": "$parameters.properties.optimize.vmBoot.state", "options": ["vm-boot-state"], "group": "VmBoot", "help": {"short": "Enabling this field will improve VM boot time by optimizing the final customized image output."}, "enum": {"items": [{"name": "Disabled", "value": "Disabled"}, {"name": "Enabled", "value": "Enabled"}]}}]}], "subresourceSelector": {"var": "$Subresource", "ref": "$Instance", "json": {"type": "object", "name": "parameters", "prop": {"type": "object", "name": "properties.optimize"}}}, "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}, {"instanceCreate": {"ref": "$Subresource", "json": {"schema": {"type": "object", "name": "parameters.properties.optimize", "required": true, "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "arg": "$parameters.properties.optimize.vmBoot.state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}}}}, {"longRunning": {"finalStateVia": "azure-async-operation"}, "operationId": "VirtualMachineImageTemplates_CreateOrUpdate", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"ref": "$Instance"}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "@ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Subresource", "clientFlatten": true}], "confirmation": ""}, {"name": "update", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "subresource": "properties.optimize", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["image-template-name"], "required": true, "group": "", "idPart": "name", "help": {"short": "The name of the image template."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}, {"name": "Parameters.properties.optimize", "args": [{"nullable": true, "type": "object", "var": "$parameters.properties.optimize.vmBoot", "options": ["vm-boot"], "group": "Parameters.properties.optimize", "help": {"short": "Optimization is applied on the image for a faster VM boot."}, "args": [{"nullable": true, "type": "string", "var": "$parameters.properties.optimize.vmBoot.state", "options": ["state"], "help": {"short": "Enabling this field will improve VM boot time by optimizing the final customized image output."}, "enum": {"items": [{"name": "Disabled", "value": "Disabled"}, {"name": "Enabled", "value": "Enabled"}]}}]}]}], "subresourceSelector": {"var": "$Subresource", "ref": "$Instance", "json": {"type": "object", "name": "parameters", "prop": {"type": "object", "name": "properties.optimize"}}}, "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}, {"instanceUpdate": {"ref": "$Subresource", "json": {"schema": {"type": "object", "name": "parameters.properties.optimize", "required": true, "props": [{"type": "object", "name": "vmBoot", "arg": "$parameters.properties.optimize.vmBoot", "props": [{"type": "string", "name": "state", "arg": "$parameters.properties.optimize.vmBoot.state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}}}}, {"longRunning": {"finalStateVia": "azure-async-operation"}, "operationId": "VirtualMachineImageTemplates_CreateOrUpdate", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"ref": "$Instance"}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "@ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Subresource", "clientFlatten": true}], "confirmation": ""}, {"name": "remove", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "subresource": "properties.optimize", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["image-template-name"], "required": true, "group": "", "idPart": "name", "help": {"short": "The name of the image template."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}], "subresourceSelector": {"var": "$Subresource", "ref": "$Instance", "json": {"type": "object", "name": "parameters", "prop": {"type": "object", "name": "properties.optimize"}}}, "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}, {"instanceDelete": {"ref": "$Subresource", "json": {}}}, {"longRunning": {"finalStateVia": "azure-async-operation"}, "operationId": "VirtualMachineImageTemplates_CreateOrUpdate", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"ref": "$Instance"}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "@ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "confirmation": "Are you sure you want to perform this operation?"}, {"name": "show", "version": "2022-07-01", "resources": [{"id": "/subscriptions/{}/resourcegroups/{}/providers/microsoft.virtualmachineimages/imagetemplates/{}", "version": "2022-07-01", "subresource": "properties.optimize", "swagger": "mgmt-plane/imagebuilder/ResourceProviders/Microsoft.VirtualMachineImages/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuVmlydHVhbE1hY2hpbmVJbWFnZXMvaW1hZ2VUZW1wbGF0ZXMve2ltYWdlVGVtcGxhdGVOYW1lfQ==/V/MjAyMi0wNy0wMQ=="}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.imageTemplateName", "options": ["image-template-name"], "required": true, "group": "", "idPart": "name", "help": {"short": "The name of the image template."}, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "ResourceGroupName", "var": "$Path.resourceGroupName", "options": ["g", "resource-group"], "required": true, "idPart": "resource_group"}, {"type": "SubscriptionId", "var": "$Path.subscriptionId", "options": ["subscription"], "required": true, "idPart": "subscription"}]}], "subresourceSelector": {"var": "$Subresource", "ref": "$Instance", "json": {"type": "object", "name": "parameters", "prop": {"type": "object", "name": "properties.optimize"}}}, "operations": [{"operationId": "VirtualMachineImageTemplates_Get", "http": {"path": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.VirtualMachineImages/imageTemplates/{imageTemplateName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "imageTemplateName", "arg": "$Path.imageTemplateName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "resourceGroupName", "arg": "$Path.resourceGroupName", "required": true}, {"type": "string", "name": "subscriptionId", "arg": "$Path.subscriptionId", "required": true}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-07-01"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/subscriptions/{}/resourceGroups/{}/providers/Microsoft.VirtualMachineImages/imageTemplates/{}"}}, {"type": "IdentityObject", "name": "identity", "required": true, "props": [{"type": "string", "name": "type", "enum": {"items": [{"value": "None"}, {"value": "UserAssigned"}]}}, {"type": "object", "name": "userAssignedIdentities", "additionalProps": {"item": {"type": "object", "props": [{"readOnly": true, "type": "string", "name": "clientId"}, {"readOnly": true, "type": "string", "name": "principalId"}]}}}]}, {"type": "ResourceLocation", "name": "location", "required": true}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"default": {"value": 0}, "type": "integer32", "name": "buildTimeoutInMinutes", "format": {"maximum": 960, "minimum": 0}}, {"type": "array<object>", "name": "customize", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}, {"value": "WindowsRestart"}, {"value": "WindowsUpdate"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}, {"property": "type", "value": "WindowsRestart", "props": [{"type": "string", "name": "restartCheckCommand"}, {"type": "string", "name": "restartCommand"}, {"type": "string", "name": "restartTimeout"}]}, {"property": "type", "value": "WindowsUpdate", "props": [{"type": "array<string>", "name": "filters", "item": {"type": "string"}}, {"type": "string", "name": "searchCriteria"}, {"default": {"value": 0}, "type": "integer32", "name": "updateLimit", "format": {"minimum": 0}}]}]}}, {"type": "array<object>", "name": "distribute", "required": true, "item": {"type": "object", "props": [{"type": "object", "name": "artifactTags", "additionalProps": {"item": {"type": "string"}}}, {"type": "string", "name": "runOutputName", "required": true, "format": {"pattern": "^[A-Za-z0-9-_.]{1,64}$"}}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "SharedImage"}, {"value": "VHD"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}, {"type": "string", "name": "location", "required": true}]}, {"property": "type", "value": "SharedImage", "props": [{"default": {"value": false}, "type": "boolean", "name": "excludeFromLatest"}, {"type": "string", "name": "galleryImageId", "required": true}, {"type": "array<string>", "name": "replicationRegions", "item": {"type": "string"}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}, {"type": "array<object>", "name": "targetRegions", "item": {"type": "object", "props": [{"type": "string", "name": "name", "required": true}, {"default": {"value": 1}, "type": "integer32", "name": "replicaCount", "format": {"minimum": 1}}, {"type": "string", "name": "storageAccountType", "enum": {"items": [{"value": "Premium_LRS"}, {"value": "Standard_LRS"}, {"value": "Standard_ZRS"}]}}]}}, {"type": "object", "name": "versioning", "props": [{"type": "string", "name": "scheme", "required": true, "enum": {"items": [{"value": "Latest"}, {"value": "Source"}]}}], "discriminators": [{"property": "scheme", "value": "Latest", "props": [{"default": {"value": -1}, "type": "integer32", "name": "major", "format": {"minimum": -1}}]}]}]}, {"property": "type", "value": "VHD", "props": [{"type": "string", "name": "uri"}]}]}}, {"readOnly": true, "type": "string", "name": "exactStagingResourceGroup"}, {"type": "object", "name": "lastRunStatus", "props": [{"type": "dateTime", "name": "endTime"}, {"type": "string", "name": "message"}, {"type": "string", "name": "runState", "enum": {"items": [{"value": "Canceled"}, {"value": "Canceling"}, {"value": "Failed"}, {"value": "PartiallySucceeded"}, {"value": "Running"}, {"value": "Succeeded"}]}}, {"type": "string", "name": "runSubState", "enum": {"items": [{"value": "Building"}, {"value": "Customizing"}, {"value": "Distributing"}, {"value": "Optimizing"}, {"value": "Queued"}, {"value": "Validating"}]}}, {"type": "dateTime", "name": "startTime"}]}, {"type": "object", "name": "optimize", "props": [{"type": "object", "name": "vmBoot", "props": [{"type": "string", "name": "state", "enum": {"items": [{"value": "Disabled"}, {"value": "Enabled"}]}}]}]}, {"type": "object", "name": "provisioningError", "props": [{"type": "string", "name": "message"}, {"type": "string", "name": "provisioningErrorCode", "enum": {"items": [{"value": "BadCustomizerType"}, {"value": "BadDistributeType"}, {"value": "BadManagedImageSource"}, {"value": "BadPIRSource"}, {"value": "BadSharedImageDistribute"}, {"value": "BadSharedImageVersionSource"}, {"value": "BadSourceType"}, {"value": "BadStagingResourceGroup"}, {"value": "BadValidatorType"}, {"value": "NoCustomizerScript"}, {"value": "NoValidatorScript"}, {"value": "Other"}, {"value": "ServerError"}, {"value": "UnsupportedCustomizerType"}, {"value": "UnsupportedValidatorType"}]}}]}, {"type": "string", "name": "provisioningState", "enum": {"items": [{"value": "Canceled"}, {"value": "Creating"}, {"value": "Deleting"}, {"value": "Failed"}, {"value": "Succeeded"}, {"value": "Updating"}]}}, {"type": "object", "name": "source", "required": true, "props": [{"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "ManagedImage"}, {"value": "PlatformImage"}, {"value": "SharedImageVersion"}]}}], "discriminators": [{"property": "type", "value": "ManagedImage", "props": [{"type": "string", "name": "imageId", "required": true}]}, {"property": "type", "value": "PlatformImage", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "offer"}, {"type": "object", "name": "planInfo", "props": [{"type": "string", "name": "planName", "required": true}, {"type": "string", "name": "planProduct", "required": true}, {"type": "string", "name": "planPublisher", "required": true}]}, {"type": "string", "name": "publisher"}, {"type": "string", "name": "sku"}, {"type": "string", "name": "version"}]}, {"property": "type", "value": "SharedImageVersion", "props": [{"readOnly": true, "type": "string", "name": "exactVersion"}, {"type": "string", "name": "imageVersionId", "required": true}]}]}, {"type": "string", "name": "stagingResourceGroup"}, {"type": "object", "name": "validate", "props": [{"default": {"value": false}, "type": "boolean", "name": "continueDistributeOnFailure"}, {"type": "array<object>", "name": "inVMValidations", "item": {"type": "object", "props": [{"type": "string", "name": "name"}, {"type": "string", "name": "type", "required": true, "enum": {"items": [{"value": "File"}, {"value": "PowerShell"}, {"value": "Shell"}]}}], "discriminators": [{"property": "type", "value": "File", "props": [{"type": "string", "name": "destination"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "string", "name": "sourceUri"}]}, {"property": "type", "value": "PowerShell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"default": {"value": false}, "type": "boolean", "name": "runAsSystem"}, {"default": {"value": false}, "type": "boolean", "name": "runElevated"}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}, {"type": "array<integer32>", "name": "validExitCodes", "item": {"type": "integer32"}}]}, {"property": "type", "value": "Shell", "props": [{"type": "array<string>", "name": "inline", "item": {"type": "string"}}, {"type": "string", "name": "scriptUri"}, {"default": {"value": ""}, "type": "string", "name": "sha256Checksum"}]}]}}, {"default": {"value": false}, "type": "boolean", "name": "sourceValidationOnly"}]}, {"type": "object", "name": "vmProfile", "props": [{"default": {"value": 0}, "type": "integer32", "name": "osDiskSizeGB", "format": {"minimum": 0}}, {"type": "array<string>", "name": "userAssignedIdentities", "item": {"type": "string"}}, {"default": {"value": ""}, "type": "string", "name": "vmSize"}, {"type": "object", "name": "vnetConfig", "props": [{"default": {"value": ""}, "type": "string", "name": "proxyVmSize"}, {"type": "string", "name": "subnetId"}]}]}], "clientFlatten": true}, {"readOnly": true, "type": "object", "name": "systemData", "props": [{"type": "dateTime", "name": "createdAt"}, {"type": "string", "name": "createdBy"}, {"type": "string", "name": "createdByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}, {"type": "dateTime", "name": "lastModifiedAt"}, {"type": "string", "name": "lastModifiedBy"}, {"type": "string", "name": "lastModifiedByType", "enum": {"items": [{"value": "Application"}, {"value": "Key"}, {"value": "ManagedIdentity"}, {"value": "User"}]}}]}, {"type": "object", "name": "tags", "additionalProps": {"item": {"type": "string"}}}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "ImageTemplate_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@ODataV4Format"}}}}]}}], "outputs": [{"type": "object", "ref": "$Subresource", "clientFlatten": true}], "confirmation": ""}]}]}]}